const sections = [
    //Maths Section
    [
        {
          "question": "If x + 1/x = 3, then find the value of x³ + 1/x³.",
          "options": ["18", "21", "24", "27"],
          "answer": "18"
        },
        {
          "question": "A train crosses a pole in 15 seconds and a platform 100 m long in 25 seconds. Find the length of the train.",
          "options": ["150 m", "100 m", "200 m", "250 m"],
          "answer": "150 m"
        },
        {
          "question": "If sin θ + cos θ = √2, then find the value of tan θ + cot θ.",
          "options": ["1", "2", "3", "4"],
          "answer": "2"
        },
        {
          "question": "The average of 10 numbers is 12. If each number is multiplied by 2, what is the new average?",
          "options": ["12", "18", "24", "36"],
          "answer": "24"
        },
        {
          "question": "A sum of money becomes 8 times itself in 15 years at simple interest. What is the rate of interest per annum?",
          "options": ["35%", "40%", "45%", "50%"],
          "answer": "50%"
        },
        {
          "question": "If a:b = 2:3 and b:c = 4:5, then find a:b:c.",
          "options": ["8:12:15", "6:9:10", "4:6:9", "2:3:5"],
          "answer": "8:12:15"
        },
        {
          "question": "What is the remainder when 2^100 is divided by 17?",
          "options": ["1", "4", "8", "16"],
          "answer": "16"
        },
        {
          "question": "A and B can complete a piece of work in 12 days. B and C can complete it in 15 days. C and A can complete it in 20 days. In how many days can A alone complete the work?",
          "options": ["10", "20", "30", "40"],
          "answer": "20"
        },
          {
          "question": "If cos² θ - sin² θ = 1/2, then find the value of tan² θ.",
          "options": ["1/3", "1/2", "1", "3"],
          "answer": "1/3"
        },
        {
          "question": "The difference between compound interest and simple interest on a sum of money for 2 years at 10% per annum is ₹63. Find the sum.",
          "options": ["₹6300", "₹6000", "₹5500", "₹6500"],
          "answer": "₹6300"
        },
        {
          "question": "If a + b + c = 6 and a² + b² + c² = 14, then find the value of ab + bc + ca.",
          "options": ["11", "12", "13", "14"],
          "answer": "11"
        },
        {
          "question": "A mixture of 40 liters of milk and water contains 10% water. How much water must be added to make the water 20% in the new mixture?",
          "options": ["5 liters", "6 liters", "7 liters", "8 liters"],
          "answer": "5 liters"
        },
        {
          "question": "If sec θ + tan θ = 3, then find the value of sec θ - tan θ.",
          "options": ["1/3", "1/2", "1", "2"],
          "answer": "1/3"
        },
        {
          "question": "A boat can travel 12 km downstream and 8 km upstream in 5 hours. If the speed of the boat in still water is 4 km/hr, what is the speed of the stream?",
          "options": ["1 km/hr", "2 km/hr", "3 km/hr", "4 km/hr"],
          "answer": "2 km/hr"
        },
        {
          "question": "If x = √5 + √3 / √5 - √3, then find the value of x + 1/x.",
          "options": ["2", "4", "6", "8"],
          "answer": "8"
        },
        {
          "question": "The ratio of the areas of two similar triangles is 16:25. If the length of a side of the smaller triangle is 4 cm, then find the length of the corresponding side of the larger triangle.",
          "options": ["5 cm", "6 cm", "7 cm", "8 cm"],
          "answer": "5 cm"
        },
        {
          "question": "What is the value of sin 120° + cos 150°?",
          "options": ["0", "1", "√3/2", "-√3/2"],
          "answer": "0"
        },
        {
          "question": "A person sold an article at a loss of 20%. If he had sold it for ₹200 more, he would have gained 5%. Find the cost price of the article.",
          "options": ["₹800", "₹750", "₹850", "₹900"],
          "answer": "₹800"
        },
        {
          "question": "If 3^x = 27^y = 81^z and x + y + z = 13, then find the value of x.",
          "options": ["6", "8", "9", "12"],
          "answer": "9"
        },
        {
          "question": "The perimeter of a triangle is 30 cm and its area is 30 cm². If the longest side is 13 cm, what is the length of the shortest side?",
          "options": ["5 cm", "6 cm", "7 cm", "8 cm"],
          "answer": "5 cm"
        },
        {
          "question": "If tan θ + cot θ = 2, then find the value of tan^10 θ + cot^10 θ.",
          "options": ["1", "2", "10", "20"],
          "answer": "2"
        },
        {
          "question": "A cylindrical tank has a radius of 7 cm and a height of 20 cm. Find the volume of the tank.",
          "options": ["3080 cm³", "3180 cm³", "3280 cm³", "3380 cm³"],
          "answer": "3080 cm³"
        },
        {
          "question": "If a/b = 2/3, b/c = 4/5, and c/d = 6/7, then find a/d.",
          "options": ["16/35", "18/35", "20/35", "22/35"],
          "answer": "16/35"
        },
        {
          "question": "Find the value of (sin² 30° + cos² 60° + tan 45°).",
          "options": ["1", "3/2", "2", "5/2"],
          "answer": "3/2"
        },
        {
          "question": "A shopkeeper marks up an article by 50% and then gives a discount of 20%. What is the overall profit percentage?",
          "options": ["10%", "20%", "30%", "40%"],
          "answer": "20%"
        }
      ],
    // Reasoning Section
    [
        {
          "question": "If 'REASON' is coded as 5, 'BELIEVED' is coded as 7, then what will be the code for 'GOVERNMENT'?",
          "options": ["8", "9", "10", "11"],
          "answer": "10"
        },
        {
          "question": "Choose the missing number: 4, 18, ?, 100, 180, 294.",
          "options": ["36", "48", "50", "58"],
          "answer": "48"
        },
        {
          "question": "Statements: All pens are roads. All roads are houses. Some houses are rivers. Conclusions: I. Some rivers are pens. II. All houses are pens. Which conclusion(s) logically follow?",
          "options": ["Only I", "Only II", "Both I and II", "Neither I nor II"],
          "answer": "Neither I nor II"
        },
        {
          "question": "Pointing to a photograph, a man said, 'I have no brother or sister, but that man's father is my father's son.' Whose photograph was it?",
          "options": ["His son", "His father", "His nephew", "His own"],
          "answer": "His son"
        },
        {
          "question": "Find the odd one out: 121, 144, 169, 188, 225.",
          "options": ["121", "144", "169", "188"],
          "answer": "188"
        },
        {
          "question": "If '+' means '-', '-' means '*', '*' means '/', and '/' means '+', then what is the value of 16 / 8 * 6 - 2 + 1?",
          "options": ["14", "15", "16", "17"],
          "answer": "17"
        },
        {
          "question": "A series is given with one term missing. Choose the correct alternative from the given ones that will complete the series: BZA, DYB, FXC, ?",
          "options": ["HWD", "GWD", "HWE", "GWE"],
          "answer": "HWD"
        },
        {
          "question": "How many triangles are there in the given figure? (Imagine a complex figure with many triangles).",
          "options": ["18", "20", "22", "24"],
          "answer": "20"
        },
        {
          "question": "If 'CLOUD' is coded as 'GTRKF', then 'SIGHT' will be coded as?",
          "options": ["WKVHT", "VKWHT", "UKVHT", "WKUHT"],
          "answer": "VKWHT"
        },
        {
          "question": "Choose the missing number: 3, 10, 24, ?, 120, 248.",
          "options": ["48", "52", "60", "72"],
          "answer": "48"
        },
        {
          "question": "Statements: Some actors are singers. All singers are dancers. Conclusions: I. Some actors are dancers. II. No actor is a dancer. Which conclusion(s) logically follow?",
          "options": ["Only I", "Only II", "Both I and II", "Neither I nor II"],
          "answer": "Only I"
        },
        {
          "question": "A is the father of C. D is the son of B. E is the brother of A. If C is the sister of D, how is B related to A?",
          "options": ["Wife", "Sister", "Daughter", "Brother"],
          "answer": "Wife"
        },
        {
          "question": "Find the odd one out: 24, 36, 48, 52, 60.",
          "options": ["24", "36", "48", "52"],
          "answer": "52"
        },
        {
          "question": "If 'P' denotes '+', 'Q' denotes '-', 'R' denotes '*', and 'S' denotes '/', then what is the value of 16 R 12 P 48 S 8 Q 10?",
          "options": ["56", "66", "76", "86"],
          "answer": "66"
        },
        {
          "question": "A series is given with one term missing. Choose the correct alternative that will complete the series: ACE, GIK, MOQ, ?",
          "options": ["STW", "SUV", "SUW", "TVW"],
          "answer": "SUW"
        },
        {
          "question": "How many squares are there in the given figure? (Imagine a complex figure with multiple squares).",
          "options": ["25", "28", "30", "32"],
          "answer": "30"
        },
        {
          "question": "If 'SYSTEM' is coded as '13162513', then 'REASON' will be coded as?",
          "options": ["18511914", "18511915", "19511814", "19511815"],
          "answer": "18511914"
        },
        {
          "question": "Choose the missing number: 2, 5, 10, 17, ?, 37.",
          "options": ["24", "26", "28", "30"],
          "answer": "26"
        },
        {
          "question": "Statements: All flowers are trees. Some trees are houses. Conclusions: I. Some houses are flowers. II. No flower is a house. Which conclusion(s) logically follow?",
          "options": ["Only I", "Only II", "Both I and II", "Neither I nor II"],
          "answer": "Neither I nor II"
        },
        {
          "question": "A is the sister of B. B is the daughter of C. C is the wife of D. How is A related to D?",
          "options": ["Sister", "Daughter", "Aunt", "Niece"],
          "answer": "Daughter"
        },
        {
          "question": "Find the odd one out: 17, 29, 37, 47, 51.",
          "options": ["17", "29", "37", "51"],
          "answer": "51"
        },
        {
          "question": "If 'A' means '+', 'B' means '-', 'C' means '*', and 'D' means '/', then what is the value of 18 C 14 B 6 A 16 D 4?",
          "options": ["254", "256", "258", "260"],
          "answer": "256"
        },
        {
          "question": "A series is given with one term missing. Choose the correct alternative that will complete the series: ZWTP, VTSM, SRJL, ?",
          "options": ["QPIJ", "QIKH", "QIKG", "QJIG"],
          "answer": "QIKG"
        },
        {
          "question": "How many circles are there in the given figure? (Imagine a complex figure with many intersecting circles).",
          "options": ["10", "12", "14", "16"],
          "answer": "12"
        },
        {
          "question": "If 'FRANCE' is coded as '138651', then 'CANADA' will be coded as?",
          "options": ["314131", "313141", "313131", "314141"],
          "answer": "314131"
        }
      ],

    // GK/GS/Current Affairs Section
    [
        {
          "question": "Which constitutional amendment reduced the voting age from 21 to 18 years?",
          "options": ["42nd Amendment", "44th Amendment", "61st Amendment", "73rd Amendment"],
          "answer": "61st Amendment"
        },
        {
          "question": "The 'Ryotwari System' of land revenue was introduced by which British administrator?",
          "options": ["Lord Cornwallis", "Lord Wellesley", "Thomas Munro", "Lord Dalhousie"],
          "answer": "Thomas Munro"
        },
        {
          "question": "Which of the following is responsible for the 'red color' of the Red Sea?",
          "options": ["Presence of iron oxides", "Algal blooms", "Coral reefs", "Sedimentary rocks"],
          "answer": "Algal blooms"
        },
        {
          "question": "The 'Basel Convention' deals with the control of transboundary movements of which waste?",
          "options": ["Nuclear waste", "Plastic waste", "Hazardous waste", "Medical waste"],
          "answer": "Hazardous waste"
        },
        {
          "question": "Who authored the ancient Indian text 'Natyashastra'?",
          "options": ["Panini", "Bharata Muni", "Kautilya", "Kalidasa"],
          "answer": "Bharata Muni"
        },
        {
          "question": "The 'Subsidiary Alliance' policy was introduced by which Governor-General?",
          "options": ["Warren Hastings", "Lord Cornwallis", "Lord Wellesley", "Lord William Bentinck"],
          "answer": "Lord Wellesley"
        },
        {
          "question": "Which of the following is the primary component of 'biogas'?",
          "options": ["Carbon dioxide", "Methane", "Nitrogen", "Hydrogen"],
          "answer": "Methane"
        },
        {
          "question": "The 'Jog Falls' are located on which river?",
          "options": ["Krishna", "Godavari", "Sharavathi", "Kaveri"],
          "answer": "Sharavathi"
        },
        {
          "question": "The 'National Emergency' under Article 352 has been declared how many times in India?",
          "options": ["Once", "Twice", "Thrice", "Four times"],
          "answer": "Thrice"
        },
        {
          "question": "Which of the following dance forms is associated with 'Devadasis'?",
          "options": ["Kathak", "Manipuri", "Odissi", "Sattriya"],
          "answer": "Odissi"
        },
        {
          "question": "The 'Fiscal Responsibility and Budget Management (FRBM) Act' was passed in which year?",
          "options": ["1998", "2000", "2003", "2005"],
          "answer": "2003"
        },
        {
          "question": "Which of the following is a tributary of the 'Indus River'?",
          "options": ["Ganga", "Yamuna", "Chenab", "Brahmaputra"],
          "answer": "Chenab"
        },
        {
          "question": "The 'Poona Pact' was signed between which two leaders?",
          "options": ["Gandhi and Nehru", "Gandhi and Ambedkar", "Nehru and Patel", "Ambedkar and Jinnah"],
          "answer": "Gandhi and Ambedkar"
        },
        {
          "question": "Which of the following is a 'sedimentary rock'?",
          "options": ["Granite", "Gneiss", "Sandstone", "Marble"],
          "answer": "Sandstone"
        },
        {
          "question": "The concept of 'Concurrent List' in the Indian Constitution is borrowed from which country?",
          "options": ["USA", "Canada", "Australia", "UK"],
          "answer": "Australia"
        },
        {
          "question": "Who was the first recipient of the 'Jnanpith Award'?",
          "options": ["Mahadevi Verma", "G. Sankara Kurup", "Sumitranandan Pant", "Amrita Pritam"],
          "answer": "G. Sankara Kurup"
        },
        {
          "question": "Which of the following is a 'noble gas'?",
          "options": ["Oxygen", "Nitrogen", "Argon", "Chlorine"],
          "answer": "Argon"
        },
        {
          "question": "The 'Kakori Conspiracy' took place in which year?",
          "options": ["1919", "1922", "1925", "1930"],
          "answer": "1925"
        },
        {
          "question": "Which state in India has the highest 'Mangrove Forest' cover?",
          "options": ["Gujarat", "Andhra Pradesh", "West Bengal", "Odisha"],
          "answer": "West Bengal"
        },
        {
          "question": "The 'Doctrine of Lapse' was introduced by which Governor-General?",
          "options": ["Lord Canning", "Lord Dalhousie", "Lord Ripon", "Lord Curzon"],
          "answer": "Lord Dalhousie"
        },
        {
          "question": "Which 'Vitamin' is synthesized in the human body by exposure to sunlight?",
          "options": ["Vitamin A", "Vitamin B", "Vitamin C", "Vitamin D"],
          "answer": "Vitamin D"
        },
        {
          "question": "The 'Champaran Satyagraha' was primarily against which practice?",
          "options": ["Salt tax", "Indigo cultivation", "Land revenue", "Untouchability"],
          "answer": "Indigo cultivation"
        },
        {
          "question": "Which of the following is a 'warm ocean current'?",
          "options": ["Labrador Current", "Benguela Current", "Gulf Stream", "Canary Current"],
          "answer": "Gulf Stream"
        },
        {
          "question": "The 'Rajya Sabha' can delay a money bill for a maximum period of how many days?",
          "options": ["7 days", "14 days", "30 days", "60 days"],
          "answer": "14 days"
        },
        {
          "question": "Who was the founder of the 'Servants of India Society'?",
          "options": ["Bal Gangadhar Tilak", "Gopal Krishna Gokhale", "Annie Besant", "Dadabhai Naoroji"],
          "answer": "Gopal Krishna Gokhale"
        }
      ],
    [
        {
          "question": "Select the most appropriate synonym of 'INSIDIOUS'.",
          "options": ["Obvious", "Straightforward", "Treacherous", "Honest"],
          "answer": "Treacherous"
        },
        {
          "question": "Choose the antonym of 'REPUGNANT'.",
          "options": ["Appealing", "Disgusting", "Offensive", "Revolting"],
          "answer": "Appealing"
        },
        {
          "question": "Identify the correctly spelt word.",
          "options": ["Connoisseur", "Connoisseaur", "Connossieur", "Conoisseur"],
          "answer": "Connoisseur"
        },
        {
          "question": "Fill in the blank with the appropriate preposition: 'They were accused ______ fraud.'",
          "options": ["of", "for", "with", "by"],
          "answer": "of"
        },
        {
          "question": "Select the most appropriate meaning of the idiom: 'To throw down the gauntlet'.",
          "options": ["To accept defeat", "To issue a challenge", "To avoid conflict", "To make peace"],
          "answer": "To issue a challenge"
        },
        {
          "question": "Choose the one word substitution for 'A person who is excessively anxious about their health'.",
          "options": ["Hypochondriac", "Misanthrope", "Ascetic", "Philistine"],
          "answer": "Hypochondriac"
        },
        {
          "question": "Identify the part of the sentence that has an error: 'The teacher asked the students if everyone of them were interested in going for the excursion.'",
          "options": ["The teacher asked the students", "if everyone of them", "were interested", "in going for the excursion"],
          "answer": "were interested"
        },
        {
          "question": "Select the most appropriate passive form of the given sentence: 'The committee has submitted its report.'",
          "options": ["Its report has been submitted by the committee.", "Its report was submitted by the committee.", "Its report is submitted by the committee.", "Its report had been submitted by the committee."],
          "answer": "Its report has been submitted by the committee."
        },
        {
          "question": "Choose the correct indirect form of the sentence: 'She said, 'Let's go for a walk.'",
          "options": ["She suggested that they should go for a walk.", "She said that they will go for a walk.", "She said that they went for a walk.", "She suggested that they go for a walk."],
          "answer": "She suggested that they should go for a walk."
        },
        {
          "question": "Fill in the blank with the correct article: 'He is ______ heir to a large fortune.'",
          "options": ["a", "an", "the", "no article"],
          "answer": "an"
        },
        {
          "question": "Select the most appropriate synonym of 'PERTINACIOUS'.",
          "options": ["Flexible", "Vacillating", "Persistent", "Indecisive"],
          "answer": "Persistent"
        },
        {
          "question": "Choose the antonym of 'IMPUGN'.",
          "options": ["Validate", "Deny", "Contradict", "Dispute"],
          "answer": "Validate"
        },
        {
          "question": "Identify the correctly spelt word.",
          "options": ["Equanimous", "Equanimus", "Equanemous", "Equanimous"],
          "answer": "Equanimous"
        },
        {
          "question": "Fill in the blank with the appropriate preposition: 'The plan is contingent ______ their approval.'",
          "options": ["upon", "in", "at", "with"],
          "answer": "upon"
        },
        {
          "question": "Select the most appropriate meaning of the idiom: 'To take someone for a ride'.",
          "options": ["To give someone a lift", "To deceive someone", "To entertain someone", "To teach someone a lesson"],
          "answer": "To deceive someone"
        },
        {
          "question": "Choose the one word substitution for 'The act of killing one's brother'.",
          "options": ["Fratricide", "Regicide", "Genocide", "Homicide"],
          "answer": "Fratricide"
        },
        {
          "question": "Identify the part of the sentence that has an error: 'No sooner did he entered the room when the lights went out.'",
          "options": ["No sooner did he entered", "the room when", "the lights went out", "no error"],
          "answer": "No sooner did he entered"
        },
        {
          "question": "Select the most appropriate passive form of the given sentence: 'They should have informed us earlier.'",
          "options": ["We should have been informed earlier.", "We should be informed earlier.", "We were informed earlier.", "We had been informed earlier."],
          "answer": "We should have been informed earlier."
        },
        {
          "question": "Choose the correct indirect form of the sentence: 'He exclaimed, 'What a beautiful sunset!'",
          "options": ["He exclaimed that it was a very beautiful sunset.", "He said that it is a beautiful sunset.", "He asked if it was a beautiful sunset.", "He exclaimed that what a beautiful sunset it is."],
          "answer": "He exclaimed that it was a very beautiful sunset."
        },
        {
          "question": "Fill in the blank with the correct article: 'He is ______ European citizen.'",
          "options": ["a", "an", "the", "no article"],
          "answer": "a"
        },
        {
          "question": "Select the most appropriate synonym of 'ENIGMATIC'.",
          "options": ["Clear", "Obvious", "Puzzling", "Straightforward"],
          "answer": "Puzzling"
        },
        {
          "question": "Choose the antonym of 'LACERATION'.",
          "options": ["Wound", "Healing", "Tear", "Cut"],
          "answer": "Healing"
        },
        {
          "question": "Identify the correctly spelt word.",
          "options": ["Millennium", "Millenium", "Milleneum", "Milleneium"],
          "answer": "Millennium"
        },
        {
          "question": "Fill in the blank with the appropriate preposition: 'He is adept ______ solving complex problems.'",
          "options": ["at", "in", "on", "with"],
          "answer": "at"
        },
        {
          "question": "Select the most appropriate meaning of the idiom: 'To be in the doldrums'.",
          "options": ["To be very happy", "To be in a state of inactivity or stagnation", "To be extremely busy", "To be very angry"],
          "answer": "To be in a state of inactivity or stagnation"
        }
      ]
      
]
let currentSection = 0;
let currentQuestion = 0;
let answers = {};
let markedForReview = [];
let skippedQuestions = [];
let timeLeft = 60 * 60;
let timerInterval;

// Start Timer
function startTimer() {
timerInterval = setInterval(function () {
    let minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    document.getElementById("timer").innerText = `Time Left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    if (timeLeft === 0) {
        clearInterval(timerInterval);
        submitTest();
    }
    timeLeft--;
}, 1000);
}

// Load Question
function loadQuestion(index) {
const q = sections[currentSection][index];
document.getElementById("question").innerText = `${getQuestionNumber(index)}. ${q.question}`;
const options = q.options.map((option, i) => `
    <input type="radio" name="answer" id="opt${i}" value="${option}" ${answers[`${currentSection}-${index}`] === option ? "checked" : ""}>
    <label for="opt${i}">${option}</label><br>
`).join("");
document.getElementById("options").innerHTML = options;
}



// Get Correct Question Number
function getQuestionNumber(index) {
return currentSection * 25 + index + 1;
}

// Store Answer
function storeAnswer() {
const selectedOption = document.querySelector('input[name="answer"]:checked');
if (selectedOption) {
    answers[`${currentSection}-${currentQuestion}`] = selectedOption.value;
}
}

// Switch Section
function switchSection(sectionIndex) {
storeAnswer();
currentSection = sectionIndex;
currentQuestion = 0;
loadQuestion(currentQuestion);
updateSectionBar();
}

// Highlight Active Section
function updateSectionBar() {
document.querySelectorAll('.section-bar button').forEach((btn, index) => {
    if (index === currentSection) {
        btn.classList.add('active');
    } else {
        btn.classList.remove('active');
    }
});
}

// Mark for Review
function markForReview() {
const qIndex = `${currentSection}-${currentQuestion}`;
if (!markedForReview.includes(qIndex)) {
    markedForReview.push(qIndex);
    updateReviewList();
    // alert("Question marked for review.");
}
}

// Skip Question
// Skip Question
function skipQuestion() {
const qIndex = `${currentSection}-${currentQuestion}`;

// Add skipped status to the button
if (!skippedQuestions.includes(qIndex)) {
    skippedQuestions.push(qIndex);
}

// Update button color for skipped question
const questionNumber = getQuestionNumber(currentQuestion);
const skippedBtn = document.getElementById(`btn${questionNumber}`);
if (skippedBtn) {
    skippedBtn.classList.add("skipped"); // Add skipped class
}

nextQuestion(); // Move to next question after skipping
}


// Next Question
function nextQuestion() {
storeAnswer();
if (currentQuestion < sections[currentSection].length - 1) {
    currentQuestion++;
    loadQuestion(currentQuestion);
    updateQuestionPanel(); // Update button status
} else {
    alert("You have reached the last question in this section.");
}
}

// Previous Question
function previousQuestion() {
storeAnswer(); // Save current answer before moving
if (currentQuestion > 0) {
    currentQuestion--; // Move to previous question
    loadQuestion(currentQuestion);
    updateQuestionPanel();
} 
else {
    alert("You are at the first question in this section.");
}
}


// Submit Test
function submitTest() {
storeAnswer(); // Save the current answer
clearInterval(timerInterval); // Stop the timer
calculateResult(); // Calculate the result

// Hide modal if visible
const modal = document.getElementById("exitModal");
if (modal) modal.classList.add("hidden");

// Show result and solutions
document.getElementById("result").classList.remove("hidden");
document.getElementById("solutions").classList.remove("hidden");

// Hide navigation and control buttons after submission
document.querySelectorAll(".nav-btn, #markReviewBtn, #skipBtn, #submitBtn").forEach(btn => {
    btn.style.display = "none";
});

// Hide question panel after submission
document.getElementById("questionPanel").style.display = "none";

// Hide question container after submission
document.getElementById("question-container").style.display = "none";

// Hide horizontal panel after submission
 document.querySelector(".panel-container").style.display = "none";

// Hide all section buttons after submission
document.querySelectorAll(".section-bar button").forEach(btn => {
    btn.style.display = "none";
});

 // Hide the section bar itself after submission
 document.querySelector(".section-bar").style.display = "none";

// Hide all other buttons if any
document.querySelectorAll("button").forEach(btn => {
    btn.style.display = "none";
});

// Hide the timer after submission
document.getElementById("timer").style.display = "none";

 // Disable all answer options after submission
disableOptions(); 
}
function confirmExit() {
document.getElementById("exitModal").classList.remove("hidden");
}

function closeExitModal() {
document.getElementById("exitModal").classList.add("hidden");
}


// Calculate Result
function calculateResult() {
let score = 0;
let correctCount = 0;
let wrongCount = 0;
let unattemptedCount = 0;
let totalQuestions = 100; // Total number of questions
let solutionText = "<h3>Solutions:</h3>";
let solutionCounter = 1; // Counter for solution numbering (from 1 to 100)

sections.forEach((section, sIndex) => {
    section.forEach((q, qIndex) => {
        const qID = `${sIndex}-${qIndex}`;
        const userAnswer = answers[qID] || "No Answer";
        const correctAnswer = q.answer;

        // Check correctness
        if (userAnswer === correctAnswer) {
            score += 2; // Correct answer +2
            correctCount++;
            solutionText += `
                <div style="margin-bottom: 10px;">
                    <b>${solutionCounter}. ${q.question}</b><br>
                    Your Answer: <b>${userAnswer}</b> | Correct Answer: <b>${correctAnswer}</b><br>
                    <span style="color:green;">Correct ✔️ (+2)</span>
                </div>`;
        } 
        else if (userAnswer === "No Answer") {
            unattemptedCount++;
            solutionText += `
                <div style="margin-bottom: 10px;">
                    <b>${solutionCounter}. ${q.question}</b><br>
                    <span style="color:orange;">Not Attempted ❗ (0)</span><br>
                    Correct Answer: <b>${correctAnswer}</b>
                </div>`;
        } 
        else {
            score -= 0.25; // Wrong answer -0.25
            wrongCount++;
            solutionText += `
                <div style="margin-bottom: 10px;">
                    <b>${solutionCounter}. ${q.question}</b><br>
                    Your Answer: <b>${userAnswer}</b> | Correct Answer: <b>${correctAnswer}</b><br>
                    <span style="color:red;">Wrong ❌ (-0.25)</span>
                </div>`;
        }
        solutionCounter++; // Increment solution counter
    });
});

// Calculate total marks out of 200
let totalMarks = 200;

// Display results
document.getElementById("result").innerHTML = `
    <h3>Total Marks: ${score} / ${totalMarks}</h3>
    <div id="summary">
        <p>✅ Correct Answers: <b>${correctCount}</b> | Marks: <b>${correctCount * 2}</b></p>
        <p>❌ Wrong Answers: <b>${wrongCount}</b> | Deducted: <b>${(wrongCount * 0.25).toFixed(2)}</b></p>
        <p>⏩ Not Attempted: <b>${unattemptedCount}</b></p>
    </div>
`;
document.getElementById("solutions").innerHTML = solutionText;
}

// Update Review List
function updateReviewList() {
document.getElementById("reviewed-questions").innerHTML = `Marked for Review: ${markedForReview.join(", ")}`;
}

// Disable Options after Submission
function disableOptions() {
document.querySelectorAll('input[name="answer"]').forEach(option => {
    option.disabled = true; // Disable only question options
});
}
function updateQuestionStatus() {
let statusHTML = "";
let totalQuestions = sections.reduce((sum, section) => sum + section.length, 0);

for (let i = 0; i < totalQuestions; i++) {
    const sectionIndex = Math.floor(i / 25);
    const questionIndex = i % 25;
    const qIndex = `${sectionIndex}-${questionIndex}`;
    
    if (markedForReview.includes(qIndex)) {
        statusHTML += `<div class="question-status review">🔍 Q${i + 1}: Marked for Review</div>`;
    } 
    else if (answers[qIndex]) {
        statusHTML += `<div class="question-status attempted">✅ Q${i + 1}: Attempted</div>`;
    } 
    else {
        statusHTML += `<div class="question-status not-attempted">❌ Q${i + 1}: Not Attempted</div>`;
    }
}
document.getElementById("questionStatusList").innerHTML = statusHTML;
}

// Total number of questions
const totalQuestions = 100;

// Generate question buttons dynamically
function createQuestionButtons() {
const questionPanel = document.getElementById("questionPanel");
questionPanel.innerHTML = ""; // Clear previous buttons

for (let i = 1; i <= totalQuestions; i++) {
    const btn = document.createElement("button");
    btn.innerText = i;
    btn.className = "question-btn";
    btn.id = `btn${i}`;
    btn.onclick = () => handleQuestionClick(i); // Attach click event
    questionPanel.appendChild(btn);
}
}


// Handle Question Button Click
function handleQuestionClick(questionNumber) {
storeAnswer(); // Save current answer before switching
const sectionIndex = Math.floor((questionNumber - 1) / 25); // Get section based on question number
const questionIndex = (questionNumber - 1) % 25; // Get question index in the section

if (sections[sectionIndex] && sections[sectionIndex][questionIndex]) {
    currentSection = sectionIndex; // Switch to the correct section
    currentQuestion = questionIndex; // Set to the correct question
    loadQuestion(currentQuestion);
    updateSectionBar(); // Highlight the correct section
} else {
    alert("Invalid question number!");
}
}

// Update Button Status
function updateQuestionPanel() {
for (let i = 1; i <= totalQuestions; i++) {
    const sectionIndex = Math.floor((i - 1) / 25);
    const questionIndex = (i - 1) % 25;
    const qIndex = `${sectionIndex}-${questionIndex}`;
    const btn = document.getElementById(`btn${i}`);

    if (markedForReview.includes(qIndex)) {
        btn.className = "question-btn marked";
    } 
    else if (skippedQuestions.includes(qIndex)) {
        btn.className = "question-btn skipped"; // Set to skipped if question was skipped
    } 
    else if (answers[qIndex]) {
        btn.className = "question-btn answered";
    } 
    else {
        btn.className = "question-btn not-answered";
    }
}
}



// Initialize the test
window.onload = function () {
loadQuestion(currentQuestion);
updateSectionBar();
startTimer();
createQuestionButtons();
updateQuestionPanel();
};

